spring:
  application:
    name: fitpub-test

  # Datasource automatically configured via @ServiceConnection in TestcontainersConfiguration
  # The PostgreSQL container with PostGIS is started as a standard PostgreSQL container

  datasource:
    # For dev: Start PostgreSQL with: docker run -d --name fitpub-postgres -p 5432:5432 -e POSTGRES_DB=fitpub -e POSTGRES_USER=fitpub -e POSTGRES_PASSWORD=change_me_in_production postgis/postgis:16-3.4
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5432/fitpub}
    username: ${SPRING_DATASOURCE_USERNAME:fitpub}
    password: ${SPRING_DATASOURCE_PASSWORD:change_me_in_production}
    driver-class-name: org.postgresql.Driver
  jpa:
    hibernate:
      ddl-auto: validate
    properties:
      hibernate:
        dialect: org.hibernate.spatial.dialect.postgis.PostgisPG10Dialect
        format_sql: true
    show-sql: false

  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration

  servlet:
    multipart:
      max-file-size: 50MB
      max-request-size: 50MB

fitpub:
  domain: localhost:8080
  base-url: http://localhost:8080
  activitypub:
    enabled: true
    max-federation-retries: 3
  security:
    jwt:
      secret: test-secret-key-for-jwt-token-generation-in-tests-must-be-long-enough
      expiration: 86400000 # 24 hours
  storage:
    fit-files:
      path: ${java.io.tmpdir}/fitpub-test/fit-files
      retention-days: 365
  weather:
    enabled: false
    api-key: test-api-key

logging:
  level:
    net.javahippie.fitpub: DEBUG
    org.springframework: WARN
    org.hibernate: WARN
    org.testcontainers: INFO
